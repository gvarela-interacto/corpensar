<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responder Encuesta: {{ encuesta.titulo }}</title>
</head>
<body>
    <h1>{{ encuesta.titulo }}</h1>
    <p>{{ encuesta.descripcion }}</p>

    <form method="post">
        {% csrf_token %}
        {% for field in form %}
            <div style="margin-bottom: 15px;">
                {{ field.label_tag }}
                {% if field.help_text %}
                    <br><small class="form-text text-muted">{{ field.help_text }}</small>
                {% endif %}
                {{ field }}
                {% if field.errors %}
                    <ul style="color: red;">
                        {% for error in field.errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
                {% if field.name|slice:":5" == "otro_" %}
                    <div id="{{ field.id_for_label }}_container" style="display: none; margin-top: 5px;">
                        {{ field.label_tag }} {{ field }}
                        {% if field.errors %}
                            <ul style="color: red;">
                                {% for error in field.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </div>
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            const radioButtons = document.querySelectorAll('input[type="radio"][name^="pregunta_"][value="otro"]');
                            radioButtons.forEach(radio => {
                                radio.addEventListener('change', function() {
                                    const otroFieldId = 'id_' + this.name.replace('pregunta', 'otro');
                                    const otroContainer = document.getElementById(otroFieldId + '_container');
                                    if (this.checked) {
                                        otroContainer.style.display = 'block';
                                    } else {
                                        otroContainer.style.display = 'none';
                                        const otroInput = otroContainer.querySelector('input[type="text"]');
                                        if (otroInput) {
                                            otroInput.value = ''; // Clear the 'otro' text if unchecked
                                        }
                                    }
                                });
                            });

                            const checkBoxes = document.querySelectorAll('input[type="checkbox"][name^="pregunta_"][value="otro"]');
                            checkBoxes.forEach(checkbox => {
                                checkbox.addEventListener('change', function() {
                                    const otroFieldId = 'id_' + this.name.replace('pregunta', 'otro');
                                    const otroContainer = document.getElementById(otroFieldId + '_container');
                                    if (this.checked) {
                                        otroContainer.style.display = 'block';
                                    } else {
                                        otroContainer.style.display = 'none';
                                        const otroInput = otroContainer.querySelector('input[type="text"]');
                                        if (otroInput) {
                                            otroInput.value = ''; // Clear the 'otro' text if unchecked
                                        }
                                    }
                                });
                            });
                        });
                    </script>
                {% endif %}
                {% if field.name|slice:":9" == "pregunta_" and '_item_' in field.name %}
                    <div style="margin-left: 20px;">
                        {{ field.label_tag }} {{ field }}
                        {% if field.errors %}
                            <ul style="color: red;">
                                {% for error in field.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </div>
                {% elif 'checkbox' in field.widget_type %}
                    <br>
                {% elif 'radio' in field.widget_type %}
                    <br>
                {% endif %}
            </div>
        {% endfor %}
        <button type="submit">Enviar respuestas</button>
    </form>
</body>
</html>